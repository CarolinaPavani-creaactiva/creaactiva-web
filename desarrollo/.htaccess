##########################################
# ACTIVAR REWRITE
##########################################
RewriteEngine On
RewriteBase /

##########################################
# 1️⃣ REDIRECCIÓN A WWW 
##########################################
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [R=301,L]

##########################################
# 2️⃣ OCULTAR index.php DE LA URL
##########################################
RewriteCond %{THE_REQUEST} \s/index\.php[?\s] [NC]
RewriteRule ^index\.php$ / [R=301,L]

##########################################
# 3️⃣ URLs LIMPIAS → /servicios
##########################################
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/?$ index.php?page=$1 [L,QSA]

##########################################
# 4️⃣ 404 PERSONALIZADO
##########################################
ErrorDocument 404 /404.php

##########################################
# 5️⃣ SEGURIDAD
##########################################
Options -Indexes

<Files ".htaccess">
  Require all denied
</Files>

<FilesMatch "\.(ini|log|sh|sql|bak|tpl|dist)$">
  Require all denied
</FilesMatch>

##########################################
# 6️⃣ COMPRESIÓN GZIP
##########################################
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

##########################################
# 7️⃣ CACHE DEL NAVEGADOR
##########################################
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 month"
  ExpiresByType image/jpeg "access plus 1 month"
  ExpiresByType image/png "access plus 1 month"
  ExpiresByType image/gif "access plus 1 month"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresDefault "access plus 7 days"
</IfModule>
